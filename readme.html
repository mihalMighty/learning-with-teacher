<b>ПРОЕКТ: ОБУЧЕНИЕ С УЧИТЕЛЕМ: качество модели</b><br>

<b><u>Описание задачи</u></b><br>
Отчёт интернет-магазина «В один клик» за прошлый период показал, что активность покупателей начала снижаться. Руководство магазина предпринимает попытки удерживать активность постоянных клиентов с помощью персонализированных предложений.

<b><u>Цель проекта</u></b> заключается в:
<ul>
<li>построении модели, которая предскажет вероятность снижения покупательской активности клиента в следующие три месяца;
<li>выделении сегментов покупателей и разработке для них персонализированных предложений на основании данных модели и данных о прибыльности клиентов, дополнительно полученных от финансового департамента.
</ul>

<b><u>Исходными данными</u></b> служат датафреймы <i>market_file</i>, <i>market_money</i>, <i>market_time</i> и <i>money</i>, где соответственно представленны данные, описывающие активность клиентов, выручку, принесенную клиентами за последний квартал, время, проведенное клиентами на сайте магазина в последние два месяца и прибыль от каждого клиента.

В ходе <b><u>предобработки</u></b>:
<ul>
<li>типы данных столбцов были изменены на типы, характерные для данных в этих столбцах, что позволило уменьшить объем занимаемой памяти;
<li>пропусков в данных не обнаружено;
<li>дубликатов в данных не обнаружено;
<li>в некоторых категориальных признаках датафреймов market_file, market_time обнаружены опечатки. Опечатки устранены.
</ul>

В ходе <b><u>исследовательского анализа</u></b> были построены гистограммы распределения и ящики с усами для количественных признаков и круговые диаграммы для качественных.

На этапе <b><u>корреляционного анализа</u></b> посредством инструментария <i>phik</i> выявлена сильная связь признаков <b>'Выручка_предыдущий'</b> и <b>'Выручка_текущий'</b> (коэффициент==0.84). Первый признак удален из набора данных.

Для <b><u>поиска лучшей модели</u></b> был создан пайплайн, включающий этапы:
<ul>
<li>кодирования качественных признаков (номинальных бинарных и номинального небинарного); 
<li>масштабирования количественных;
<li>обучения прогнозной модели.
</ul>

В качестве <b><u>гиперпараметров пайплайна</u></b> были заданы:
<ul> 
<li>4 варианта масштабирования количественных признаков;
<li>4 модели : <i>DecisionTreeClassifier</i>, <i>KNeighborsClassifier</i>, <i>LogisticRegression</i>, <i>SVC</i>, которым, в свою очередь, были переданы их гиперпараметры.
</ul>

<b>Лучшей</b> оказалась модель <i>SVC</i> со значением метрики <i>accuracy</i> на тестовой выборке ==<b>0.9</b>.
Однако на этапе оценки важности параметров возникли сложности с использованием инструментария <i>SHAP</i> для модели <i>SVC</i>.
Поэтому в качесве лучшей модели была взята следующая по качеству <i>LogisticRegression</i> со значением метрики <i>roc-auc</i> на тестовой выборке ==<b>0.8915</b>. Высокие значения метрики говорят о высоком прогнозном качестве моделей.

На этапе <b><u>анализа важности</u></b> признаков посредством инструментария <i>SHAP</i> было установлено, что сильнее всего влияют на целевой признак признаки:
<ul>
<li>Средний_просмотр_категорий_за_визит
<li>Страниц_за_визит    
<li>Акционные_покупки    
<li>Неоплаченные_продукты_штук_квартал
<li>Минут_предыдущий
<li>Минут_текущий
<li>Маркет_актив_6_мес    
</ul>

Полученные результаты можно <b>трактовать</b> следующим вполне очевидным образом: модель отмечает снижение активности покупателя (выставляет значение целевого признака "снизилась"), если фиксирует, что :
<ul>
<li>пользователь проводит меньше времени на сайте: просматривает меньше страниц и категорий товаров;
<li>среди его покупок преобладают акционные товары;
<li>в его корзине большое число неоплаченных товаров.     
</ul>

Опираясь на результаты моделирования, были сформулированы следующие общие <b>рекомендации</b>:
<ul>
<li>чаще информировать пользователя об акциях на товары в тех категориях, в которых он чаще совершает покупки;     
<li>предлагать пользователю больше товаров к просмотру в тех категориях, в которых он чаще совершает покупки;
<li>предлагать скидки при покупке одновременной нескольких товаров в категориях, в которых он чаще совершает покупки;
<li>предлагать персональные скидки на "избранные" товары, страницы которых пользователь часто просматривает в ожидании снижения цены;
<li>предлагать скидки на товары, долго находящиеся в корзине без оплаты. 
</ul>